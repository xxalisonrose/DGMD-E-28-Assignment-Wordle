<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Wordle, the DGMD E-28 Version</title>
    <style>
        body {
        position: relative;
        max-width: 480px;
        height: 100%;
        margin: auto;
        }

        .box {
            position: relative;
            border-style: solid;
            border-width: 2px;
            padding: 1em;
            margin-top: 3em;
        }

        h1 {
            color: #016194;
            text-align: center;
            margin-bottom: 0;
        }

        h2 {
            color: #016194;
            text-align: center;
            margin-top: 0;
        }

        #gameGrid {
            display: grid;
            grid-template-rows: repeat(5, 1fr); /* 5 columns */
            gap: 10px;
            justify-items: center;
        }

        .letter-box {
            width: 70px;
            height: 70px;
            background-color: lightblue;
            border: 1px solid blue;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: xx-large;
        }

        .letter-row {
            display: flex;
            gap: 5px;
        }

        #keyboard-cont {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #keyboard-cont div {
            display: flex;
        }

        .second-row {
            margin: 0.5rem 0;
        }

        .keyboard-button {
            font-size: 1rem;
            font-weight: 700;
            padding: 0.5rem;
            margin: 0 2px;
            cursor: pointer;
            text-transform: uppercase;
        }

    </style>
  </head>
  <body>
    <main>
    <!--a box around the game-->
    <div class="box">
        <h1>Wordle</h1>
        <h2>the DGMD E-28 Version</h2>  

    <!--5 x 6 Grid-->
    <div id="gameGrid"></div>

    <!--Display letters and match keyboard like in real Wordle game-->
    <div id="keyboard-cont">
        <div class="first-row">
            <button class="keyboard-button">q</button>
            <button class="keyboard-button">w</button>
            <button class="keyboard-button">e</button>
            <button class="keyboard-button">r</button>
            <button class="keyboard-button">t</button>
            <button class="keyboard-button">y</button>
            <button class="keyboard-button">u</button>
            <button class="keyboard-button">i</button>
            <button class="keyboard-button">o</button>
            <button class="keyboard-button">p</button>
        </div>
        <div class="second-row">
            <button class="keyboard-button">a</button>
            <button class="keyboard-button">s</button>
            <button class="keyboard-button">d</button>
            <button class="keyboard-button">f</button>
            <button class="keyboard-button">g</button>
            <button class="keyboard-button">h</button>
            <button class="keyboard-button">j</button>
            <button class="keyboard-button">k</button>
            <button class="keyboard-button">l</button>
        </div>
        <div class="third-row">
            <button class="keyboard-button">z</button>
            <button class="keyboard-button">x</button>
            <button class="keyboard-button">c</button>
            <button class="keyboard-button">v</button>
            <button class="keyboard-button">b</button>
            <button class="keyboard-button">n</button>
            <button class="keyboard-button">m</button>
        </div>
    </div>

    </div>
    </main>

    <script>
    // JS starts here
        console.log("JS loaded");

    // Create Game Board
    var board = document.getElementById("gameGrid");
    var NUM_ROWS = 6;
    var NUM_COLS = 5;

    function makeBoard() {
        for (let i = 0; i < NUM_ROWS; i++) {
        let row = document.createElement("div");
        row.className = "letter-row" + (i === 0 ? " first-row" : "");
        
        for (let j = 0; j < NUM_COLS; j++) {
            let box = document.createElement("div");
            box.className = "letter-box";
            row.appendChild(box);
        }

        board.appendChild(row);
        }
    };

    // Get random word using a random word API
    async function fetchRandomWord() {
    const url = 'https://wordsapiv1.p.rapidapi.com/words/?random=true';
    const options = {
        method: 'GET',
        headers: {
            'X-RapidAPI-Key': 'c15c5bdc06msh74c7432212cc586p106729jsn10e0b33ef973',
            'X-RapidAPI-Host': 'wordsapiv1.p.rapidapi.com'
        }
    };

    while (true) {
        try {
            var response = await fetch(url, options);
            var data = await response.json();

            

            if (Array.isArray(data)) {
                var fiveLetterWords = data.results.filter(pokemon => pokemon.name.length === 5);

                if (fiveLetterWords.length > 0 && !fiveLetterWords.some(word => word.trim() === "")) {
                    var randomIndex = Math.floor(Math.random() * fiveLetterWords.length);
                    var randomWord = fiveLetterWords[randomIndex];
                    console.log(randomWord);
                    return randomWord;
                } else {
                    console.log("Condition not met: There are not enough valid 5-letter words.");
                }
            } else {
                console.log('Invalid response format.');
            }
        } catch (error) {
            console.log('Words are hard. Try again later. Error:', error);
        }
    }
}


    var useThis = fetchRandomWord();

    console.log(useThis);
   

    
/*/



    





    









    


        // Call the getRandomWord function to fetch a random word from the Merriam-Webster API
        getRandomWord().then(word => {
            console.log('Random 5-letter word:', word);
        }).catch(error => {
            console.error('Error:', error);
        });



                // Update the game board with the random word
        async function startGame() {
            var randomWord = await getRandomWord();
            console.log('Random 5-letter word:', randomWord);
            updateGameBoard(randomWord);
}



    // Get a random word from the API and update the game board
    function updateGameBoard(word) {
        // Get all the letter boxes
        var letterBoxes = document.querySelectorAll(".letter-box");

        // Split the word into characters
        var letters = word.split("");

        // Update the letter boxes with the characters of the word
        for (var i = 0; i < letterBoxes.length; i++) {
            letterBoxes[i].textContent = letters[i].toUpperCase(); // Convert to uppercase for consistency
        }
    };

    // Make game board
    makeBoard();



    // Add key strokes in boxes
    document.addEventListener("keyup", (x) => {
        
        if (guessesRemaining === 0) {
            return
        }

        let pressedKey = String(x.key)
        if (pressedKey === "Backspace" && nextLetter !== 0) {
            deleteLetter()
            return
        }

        if (pressedKey === "Enter") {
        checkGuess()
        return
        }

        let found = pressedKey.match(/[a-z]/gi)
        if (!found || found.length > 1) {
            return
        } else {
            addLetter(pressedKey)
        }
    });

    // Add Letter
    function addLetter(pressedKey) {
        if (nextLetter === 5) {
        return
    }

    let row = document.getElementsByClassName("letter-row")[6 - guessesRemaining];
    let box = row.child[nextLetter];
    box.textContent = pressedKey;
    box.classList.add("filled-box");
    currentGuess.push(pressedKey);
    nextLetter += 1;
};

// Delete Letter
function deleteLetter () {
    let row = document.getElementsByClassName("letter-row")[6 - guessesRemaining]
    let box = row.children[nextLetter - 1]
    box.textContent = ""
    box.classList.remove("filled-box")
    currentGuess.pop()
    nextLetter -= 1
};













// Check Guess

function checkGuess () {
    let row = document.getElementsByClassName("letter-row")[6 - guessesRemaining]
    let guessString = ''
    let rightGuess = Array.from(rightGuessString)

    for (const val of currentGuess) {
        guessString += val
    }

    if (guessString.length != 5) {
        alert("Not enough letters!")
        return
    }

    if (!WORDS.includes(guessString)) {
        alert("Word not in list!")
        return
    }

    
    for (let i = 0; i < 5; i++) {
        let letterColor = ''
        let box = row.children[i]
        let letter = currentGuess[i]
        
        let letterPosition = rightGuess.indexOf(currentGuess[i])
        // is letter in the correct guess
        if (letterPosition === -1) {
            letterColor = 'grey'
        } else {
            // now, letter is definitely in word
            // if letter index and right guess index are the same
            // letter is in the right position 
            if (currentGuess[i] === rightGuess[i]) {
                // shade green 
                letterColor = 'green'
            } else {
                // shade box yellow
                letterColor = 'yellow'
            }

            rightGuess[letterPosition] = "#"
        }

        let delay = 250 * i
        setTimeout(()=> {
            //shade box
            box.style.backgroundColor = letterColor
            shadeKeyBoard(letter, letterColor)
        }, delay)
    }

    if (guessString === rightGuessString) {
        alert("You guessed right! Game over!")
        guessesRemaining = 0
        return
    } else {
        guessesRemaining -= 1;
        currentGuess = [];
        nextLetter = 0;

        if (guessesRemaining === 0) {
            alert("You've run out of guesses! Game over!")
            alert(`The right word was: "${rightGuessString}"`)
        }
    }
}

function shadeKeyBoard(letter, color) {
    for (const elem of document.getElementsByClassName("keyboard-button")) {
        if (elem.textContent === letter) {
            let oldColor = elem.style.backgroundColor
            if (oldColor === 'green') {
                return
            } 

            if (oldColor === 'yellow' && color !== 'green') {
                return
            }

            elem.style.backgroundColor = color
            break
        }
    }
}








/*/



    


        
    </script>
  </body>
</html>